<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inverse of a matrix â€¢ matlib</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">matlib</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/det-ex1.html">Properties of determinants</a>
    </li>
    <li>
      <a href="../articles/det-ex2.html">Evaluation of determinants</a>
    </li>
    <li>
      <a href="../articles/eigen-ex1.html">Eigenvalues and Eigenvectors: Properties</a>
    </li>
    <li>
      <a href="../articles/eigen-ex2.html">Eigenvalues: Spectral Decomposition</a>
    </li>
    <li>
      <a href="../articles/ginv.html">Generalized inverse</a>
    </li>
    <li>
      <a href="../articles/gramreg.html">Gram-Schmidt Orthogonalization and Regression</a>
    </li>
    <li>
      <a href="../articles/inv-ex1.html">Inverse of a matrix</a>
    </li>
    <li>
      <a href="../articles/inv-ex2.html">Matrix inversion by elementary row operations</a>
    </li>
    <li>
      <a href="../articles/linear-equations.html">Solving Linear Equations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/friendly/matlib">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Inverse of a matrix</h1>
                        <h4 class="author">Michael Friendly</h4>
            
            <h4 class="date">October 24, 2017</h4>
          </div>

    
    
<div class="contents">
<p>The inverse of a matrix plays the same roles in matrix algebra as the reciprocal of a number and division does in ordinary arithmetic: Just as we can solve a simple equation like <span class="math inline">\(4 x = 8\)</span> for <span class="math inline">\(x\)</span> by multiplying both sides by the reciprocal <span class="math display">\[ 4 x = 8 \Rightarrow 4^{-1} 4 x = 4^{-1} 8 \Rightarrow x = 8 / 4 = 2\]</span> we can solve a matrix equation like <span class="math inline">\(\mathbf{A x} = \mathbf{b}\)</span> for the vector <span class="math inline">\(\mathbf{x}\)</span> by multiplying both sides by the inverse of the matrix <span class="math inline">\(\mathbf{A}\)</span>, <span class="math display">\[\mathbf{A x} = \mathbf{b} \Rightarrow \mathbf{A}^{-1} \mathbf{A x} = \mathbf{A}^{-1} \mathbf{b} \Rightarrow \mathbf{x} = \mathbf{A}^{-1} \mathbf{b}\]</span></p>
<p>The following examples illustrate the basic properties of the inverse of a matrix.</p>
<div id="load-the-matlib-package" class="section level3">
<h3 class="hasAnchor">
<a href="#load-the-matlib-package" class="anchor"></a>Load the <code>matlib</code> package</h3>
<p>This defines: <code><a href="../reference/Inverse.html">inv()</a></code>, <code><a href="../reference/Inverse.html">Inverse()</a></code>; the standard R function for matrix inverse is <code>solve()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(matlib)</code></pre></div>
</div>
<div id="create-a-3-x-3-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-3-x-3-matrix" class="anchor"></a>Create a 3 x 3 matrix</h3>
<p>The ordinary inverse is defined only for square matrices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    A &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>,
                   <span class="dv">3</span>,-<span class="dv">1</span>, <span class="dv">2</span>,
                   <span class="dv">4</span>, <span class="dv">0</span>,-<span class="dv">1</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
   <span class="kw">det</span>(A)</code></pre></div>
<pre><code>## [1] 16</code></pre>
</div>
<div id="basic-properties" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-properties" class="anchor"></a>Basic properties</h2>
<div id="deta-0-so-inverse-exists" class="section level3">
<h3 class="hasAnchor">
<a href="#deta-0-so-inverse-exists" class="anchor"></a>1. <code>det(A) != 0</code>, so inverse exists</h3>
<p>Only non-singular matrices have an inverse.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   (AI  &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Inverse.html">inv</a></span>(A))</code></pre></div>
<pre><code>##        [,1]    [,2]   [,3]
## [1,] 0.0625  0.0625  0.125
## [2,] 0.6875 -0.3125 -0.625
## [3,] 0.2500  0.2500 -0.500</code></pre>
</div>
<div id="definition-of-the-inverse-a-1-a-a-a-1-i-or-ai-a-diagnrowa" class="section level3">
<h3 class="hasAnchor">
<a href="#definition-of-the-inverse-a-1-a-a-a-1-i-or-ai-a-diagnrowa" class="anchor"></a>2. Definition of the inverse: <span class="math inline">\(A^{-1} A = A A^{-1} = I\)</span> or <code>AI * A = diag(nrow(A))</code>
</h3>
<p>The inverse of a matrix <span class="math inline">\(A\)</span> is defined as the matrix <span class="math inline">\(A^{-1}\)</span> which multiplies <span class="math inline">\(A\)</span> to give the identity matrix, just as, for a scalar <span class="math inline">\(a\)</span>, <span class="math inline">\(a a^{-1} = a / a = 1\)</span>.</p>
<p>NB: Sometimes you will get very tiny off-diagonal values (like <code>1.341e-13</code>). The function <code>zapsmall()</code> will round those to 0.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   AI %*%<span class="st"> </span>A</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
</div>
<div id="inverse-is-reflexive-invinva-a" class="section level3">
<h3 class="hasAnchor">
<a href="#inverse-is-reflexive-invinva-a" class="anchor"></a>3. Inverse is <strong>reflexive</strong>: <code>inv(inv(A)) = A</code>
</h3>
<p>Taking the inverse twice gets you back to where you started.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>(AI)</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    5    1    0
## [2,]    3   -1    2
## [3,]    4    0   -1</code></pre>
</div>
<div id="inva-is-symmetric-if-and-only-if-a-is-symmetric" class="section level3">
<h3 class="hasAnchor">
<a href="#inva-is-symmetric-if-and-only-if-a-is-symmetric" class="anchor"></a>4. <code><a href="../reference/Inverse.html">inv(A)</a></code> is <strong>symmetric</strong> if and only if A is symmetric</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>( <span class="kw">t</span>(A) )</code></pre></div>
<pre><code>##        [,1]    [,2]  [,3]
## [1,] 0.0625  0.6875  0.25
## [2,] 0.0625 -0.3125  0.25
## [3,] 0.1250 -0.6250 -0.50</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/is_square.html">is_symmetric_matrix</a></span>(A)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/is_square.html">is_symmetric_matrix</a></span>( <span class="kw"><a href="../reference/Inverse.html">inv</a></span>( <span class="kw">t</span>(A) ) )</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Here is a symmetric case:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   B &lt;-<span class="st"> </span><span class="kw">matrix</span>( <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>,
                  <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>,
                  <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>(B)</code></pre></div>
<pre><code>##       [,1]  [,2]  [,3]
## [1,]  0.50 -0.25 -0.25
## [2,] -0.25  0.50  0.00
## [3,] -0.25  0.00  0.50</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>( <span class="kw">t</span>(B) )</code></pre></div>
<pre><code>##       [,1]  [,2]  [,3]
## [1,]  0.50 -0.25 -0.25
## [2,] -0.25  0.50  0.00
## [3,] -0.25  0.00  0.50</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/is_square.html">is_symmetric_matrix</a></span>(B)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/is_square.html">is_symmetric_matrix</a></span>( <span class="kw"><a href="../reference/Inverse.html">inv</a></span>( <span class="kw">t</span>(B) ) )</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw">all.equal</span>( <span class="kw"><a href="../reference/Inverse.html">inv</a></span>(B), <span class="kw"><a href="../reference/Inverse.html">inv</a></span>( <span class="kw">t</span>(B) ) )</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="more-properties-of-matrix-inverse" class="section level2">
<h2 class="hasAnchor">
<a href="#more-properties-of-matrix-inverse" class="anchor"></a>More properties of matrix inverse</h2>
<div id="inverse-of-diagonal-matrix-diag-1-diagonal" class="section level3">
<h3 class="hasAnchor">
<a href="#inverse-of-diagonal-matrix-diag-1-diagonal" class="anchor"></a>1. inverse of diagonal matrix = diag( 1/ diagonal)</h3>
<p>In these simple examples, it is often useful to show the results of matrix calculations as fractions, using <code><a href="http://www.rdocumentation.org/packages/MASS/topics/fractions">MASS::fractions()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   D &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>))
   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>(D)</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1  0.0 0.00
## [2,]    0  0.5 0.00
## [3,]    0  0.0 0.25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   MASS::<span class="kw">fractions</span>( <span class="kw">diag</span>(<span class="dv">1</span> /<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)) )</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   1    0    0 
## [2,]   0  1/2    0 
## [3,]   0    0  1/4</code></pre>
</div>
<div id="inverse-of-an-inverse-invinva-a" class="section level3">
<h3 class="hasAnchor">
<a href="#inverse-of-an-inverse-invinva-a" class="anchor"></a>2. Inverse of an inverse: <code>inv(inv(A)) = A</code>
</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>,  <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>,  <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
   AI &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Inverse.html">inv</a></span>(A)
   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>(AI)</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    2    3    0
## [3,]    0    1    2</code></pre>
</div>
<div id="inverse-of-a-transpose-invta-tinva" class="section level3">
<h3 class="hasAnchor">
<a href="#inverse-of-a-transpose-invta-tinva" class="anchor"></a>3. inverse of a <strong>transpose</strong>: <code>inv(t(A)) = t(inv(A))</code>
</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>( <span class="kw">t</span>(A) )</code></pre></div>
<pre><code>##       [,1] [,2]  [,3]
## [1,]  1.50 -1.0  0.50
## [2,] -0.25  0.5 -0.25
## [3,] -2.25  1.5 -0.25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw">t</span>( <span class="kw"><a href="../reference/Inverse.html">inv</a></span>(A) )</code></pre></div>
<pre><code>##       [,1] [,2]  [,3]
## [1,]  1.50 -1.0  0.50
## [2,] -0.25  0.5 -0.25
## [3,] -2.25  1.5 -0.25</code></pre>
</div>
<div id="inverse-of-a-scalar-matrix-inv-ka-1k-inva" class="section level3">
<h3 class="hasAnchor">
<a href="#inverse-of-a-scalar-matrix-inv-ka-1k-inva" class="anchor"></a>4. inverse of a scalar * matrix: <code>inv( k*A ) = (1/k) * inv(A)</code>
</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>(<span class="dv">5</span> *<span class="st"> </span>A)</code></pre></div>
<pre><code>##      [,1]  [,2]  [,3]
## [1,]  0.3 -0.05 -0.45
## [2,] -0.2  0.10  0.30
## [3,]  0.1 -0.05 -0.05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   (<span class="dv">1</span>/<span class="dv">5</span>) *<span class="st"> </span><span class="kw"><a href="../reference/Inverse.html">inv</a></span>(A)</code></pre></div>
<pre><code>##      [,1]  [,2]  [,3]
## [1,]  0.3 -0.05 -0.45
## [2,] -0.2  0.10  0.30
## [3,]  0.1 -0.05 -0.05</code></pre>
</div>
<div id="inverse-of-a-matrix-product-inva-b-invb-inva" class="section level3">
<h3 class="hasAnchor">
<a href="#inverse-of-a-matrix-product-inva-b-invb-inva" class="anchor"></a>5. inverse of a matrix product: <code>inv(A * B) = inv(B) %*% inv(A)</code>
</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>), <span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
   C &lt;-<span class="st"> </span>B[, <span class="dv">3</span>:<span class="dv">1</span>]
   A %*%<span class="st">  </span>B</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    9   20   10
## [2,]    5   13   12
## [3,]    5   11    4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>(A %*%<span class="st">  </span>B)</code></pre></div>
<pre><code>##      [,1]  [,2]  [,3]
## [1,]  4.0 -1.50 -5.50
## [2,] -2.0  0.70  2.90
## [3,]  0.5 -0.05 -0.85</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>(B) %*%<span class="st">  </span><span class="kw"><a href="../reference/Inverse.html">inv</a></span>(A)</code></pre></div>
<pre><code>##      [,1]  [,2]  [,3]
## [1,]  4.0 -1.50 -5.50
## [2,] -2.0  0.70  2.90
## [3,]  0.5 -0.05 -0.85</code></pre>
<p>This extends to any number of terms: the inverse of a product is the product of the inverses in reverse order.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   (ABC &lt;-<span class="st"> </span>A %*%<span class="st"> </span>B %*%<span class="st"> </span>C)</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   77  118   49
## [2,]   53   97   42
## [3,]   41   59   24</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>(A %*%<span class="st"> </span>B %*%<span class="st"> </span>C)</code></pre></div>
<pre><code>##      [,1]  [,2]   [,3]
## [1,]  1.5 -0.59  -2.03
## [2,] -4.5  1.61   6.37
## [3,]  8.5 -2.95 -12.15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>(C) %*%<span class="st"> </span><span class="kw"><a href="../reference/Inverse.html">inv</a></span>(B) %*%<span class="st"> </span><span class="kw"><a href="../reference/Inverse.html">inv</a></span>(A)</code></pre></div>
<pre><code>##      [,1]  [,2]   [,3]
## [1,]  1.5 -0.59  -2.03
## [2,] -4.5  1.61   6.37
## [3,]  8.5 -2.95 -12.15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">   <span class="kw"><a href="../reference/Inverse.html">inv</a></span>(ABC)</code></pre></div>
<pre><code>##      [,1]  [,2]   [,3]
## [1,]  1.5 -0.59  -2.03
## [2,] -4.5  1.61   6.37
## [3,]  8.5 -2.95 -12.15</code></pre>
</div>
<div id="det-a-1-1-deta-deta-1" class="section level3">
<h3 class="hasAnchor">
<a href="#det-a-1-1-deta-deta-1" class="anchor"></a>6. <span class="math inline">\(\det (A^{-1}) = 1 / \det(A) = [\det(A)]^{-1}\)</span>
</h3>
<p>The determinant of an inverse is the inverse (reciprocal) of the determinant</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">det</span>(AI)</code></pre></div>
<pre><code>## [1] 0.25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="dv">1</span> /<span class="st"> </span><span class="kw">det</span>(A)</code></pre></div>
<pre><code>## [1] 0.25</code></pre>
</div>
</div>
<div id="geometric-interpretations" class="section level2">
<h2 class="hasAnchor">
<a href="#geometric-interpretations" class="anchor"></a>Geometric interpretations</h2>
<p>Some of these properties of the matrix inverse can be more easily understood from geometric diagrams. Here, we take a <span class="math inline">\(2 \times 2\)</span> non-singular matrix <span class="math inline">\(A\)</span>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, 
              <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)
A</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    2    1
## [2,]    1    2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">det</span>(A)</code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>The larger the determinant of <span class="math inline">\(A\)</span>, the smaller is the determinant of <span class="math inline">\(A^{-1}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">AI &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Inverse.html">inv</a></span>(A)
MASS::<span class="kw">fractions</span>(AI)</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  2/3 -1/3
## [2,] -1/3  2/3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">det</span>(AI)</code></pre></div>
<pre><code>## [1] 0.3333</code></pre>
<p>Now, plot the rows of <span class="math inline">\(A\)</span> as vectors <span class="math inline">\(a_1, a_2\)</span> from the origin in a 2D space. As illustrated in <code><a href="../articles/det-ex1.html">vignette("det-ex1")</a></code>, the area of the parallelogram defined by these vectors is the determinant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>)+.<span class="dv">1</span>)
xlim &lt;-<span class="st"> </span><span class="kw">c</span>(-<span class="dv">1</span>,<span class="dv">3</span>)
ylim &lt;-<span class="st"> </span><span class="kw">c</span>(-<span class="dv">1</span>,<span class="dv">3</span>)
<span class="kw">plot</span>(xlim, ylim, <span class="dt">type=</span><span class="st">"n"</span>, <span class="dt">xlab=</span><span class="st">"X1"</span>, <span class="dt">ylab=</span><span class="st">"X2"</span>, <span class="dt">asp=</span><span class="dv">1</span>)
sum &lt;-<span class="st"> </span>A[<span class="dv">1</span>,] +<span class="st"> </span>A[<span class="dv">2</span>,]
<span class="co"># draw the parallelogram determined by the rows of A</span>
<span class="kw">polygon</span>( <span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), A[<span class="dv">1</span>,], sum, A[<span class="dv">2</span>,]), <span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">2</span>))
<span class="kw"><a href="../reference/vectors.html">vectors</a></span>(A, <span class="dt">labels=</span><span class="kw">c</span>(<span class="kw">expression</span>(a[<span class="dv">1</span>]), <span class="kw">expression</span>(a[<span class="dv">2</span>])), <span class="dt">pos.lab=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">2</span>))
<span class="kw"><a href="../reference/vectors.html">vectors</a></span>(sum, <span class="dt">origin=</span>A[<span class="dv">1</span>,], <span class="dt">col=</span><span class="st">"gray"</span>)
<span class="kw"><a href="../reference/vectors.html">vectors</a></span>(sum, <span class="dt">origin=</span>A[<span class="dv">2</span>,], <span class="dt">col=</span><span class="st">"gray"</span>)
<span class="kw">text</span>(<span class="kw">mean</span>(A[,<span class="dv">1</span>]), <span class="kw">mean</span>(A[,<span class="dv">2</span>]), <span class="st">"A"</span>, <span class="dt">cex=</span><span class="fl">1.5</span>)</code></pre></div>
<p><img src="inv-ex1_files/figure-html/plot-inv1-1.png" width="480"></p>
<p>The rows of the inverse <span class="math inline">\(A^{-1}\)</span> can be shown as vectors <span class="math inline">\(a^1, a^2\)</span> from the origin in the same space.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/vectors.html">vectors</a></span>(AI, <span class="dt">labels=</span><span class="kw">c</span>(<span class="kw">expression</span>(a^<span class="dv">1</span>), <span class="kw">expression</span>(a^<span class="dv">2</span>)), <span class="dt">pos.lab=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">2</span>))
sum &lt;-<span class="st"> </span>AI[<span class="dv">1</span>,] +<span class="st"> </span>AI[<span class="dv">2</span>,]
<span class="kw">polygon</span>( <span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), AI[<span class="dv">1</span>,], sum, AI[<span class="dv">2</span>,]), <span class="dt">col=</span><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">2</span>))
<span class="kw">text</span>(<span class="kw">mean</span>(AI[,<span class="dv">1</span>])-.<span class="dv">3</span>, <span class="kw">mean</span>(AI[,<span class="dv">2</span>])-.<span class="dv">2</span>, <span class="kw">expression</span>(A^{-<span class="dv">1</span>}), <span class="dt">cex=</span><span class="fl">1.5</span>)</code></pre></div>
<p><img src="inv-ex1_files/figure-html/plot-inv2-1.png" width="480"></p>
<p>Thus, we can see:</p>
<ul>
<li><p>The shape of <span class="math inline">\(A^{-1}\)</span> is a <span class="math inline">\(90^o\)</span> rotation of the shape of <span class="math inline">\(A\)</span>.</p></li>
<li><p><span class="math inline">\(A^{-1}\)</span> is small in the directions where <span class="math inline">\(A\)</span> is large.</p></li>
<li><p>The vector <span class="math inline">\(a^2\)</span> is at right angles to <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a^1\)</span> is at right angles to <span class="math inline">\(a_2\)</span></p></li>
<li><p>If we multiplied <span class="math inline">\(A\)</span> by a constant <span class="math inline">\(k\)</span> to make its determinant larger (by a factor of <span class="math inline">\(k^2\)</span>), the inverse would have to be divided by the same factor to preserve <span class="math inline">\(A A^{-1} = I\)</span>.</p></li>
</ul>
<p>One might wonder whether these properties depend on symmetry of <span class="math inline">\(A\)</span>, so here is another example, for the matrix <code>A &lt;- matrix(c(2, 1, 1, 1), nrow=2)</code>, where <span class="math inline">\(\det(A)=1\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">nrow=</span><span class="dv">2</span>))</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    2    1
## [2,]    1    1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(AI &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Inverse.html">inv</a></span>(A))</code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1   -1
## [2,]   -1    2</code></pre>
<p>The areas of the two parallelograms are the same because <span class="math inline">\(\det(A) = \det(A^{-1}) = 1\)</span>. <img src="inv-ex1_files/figure-html/plot-inv3-1.png" width="480"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#basic-properties">Basic properties</a></li>
      <li><a href="#more-properties-of-matrix-inverse">More properties of matrix inverse</a></li>
      <li><a href="#geometric-interpretations">Geometric interpretations</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michael Friendly, John Fox, Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
